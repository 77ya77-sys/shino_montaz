# План подготовки к релизу — Шиномонтаж PRO

---

## Часть 1. Senior QA Engineer — Регресс-тестирование

### 1.1. План регресс-тестирования

| № | Область | Что проверять |
|---|--------|----------------|
| 1 | HTML-разметка | Семантика, lang, viewport, связь label/input, тип кнопок, id/классы |
| 2 | Доступность (a11y) | alt у изображений, aria-атрибуты, skip-link, фокус, размеры touch-target |
| 3 | Формы и калькулятор | Значения по умолчанию, расчёт цены, список услуг, кнопка «Зафиксировать цену» |
| 4 | Модальное окно | Открытие/закрытие, backdrop, Escape, focus trap, валидация, успех |
| 5 | Навигация и меню | Бургер, десктоп-нав, ScrollSpy, активные ссылки, якоря |
| 6 | Карусель отзывов | Стрелки, скролл, доступность |
| 7 | Плашка калькулятора | Видимость при скролле (мобильная/десктоп), классы на body |
| 8 | CSS | Переменные, reset, без inline, mobile-first, глубина селекторов |
| 9 | JS | IIFE, DOMContentLoaded, отсутствие глобальных, обработка null |
| 10 | Страница privacy.html | Разметка, ссылки, списки, viewport |

### 1.2. Отчёт о найденных багах и проблемах

#### Критичные

- **BUG-QA-1.** Кнопка «Позвонить» на мобиле: в `@media (max-width: 768px)` заданы `width: 40px`, `height: 40px`, `min-width: 40px`, `min-height: 40px` — меньше минимального touch-target 44×44 px по правилам проекта и WCAG.

- **BUG-QA-2.** Футер, соцсети: у `.footer__social a` в `:focus-visible` задано `outline: none` — фокус с клавиатуры визуально не выделяется, нарушение доступности.

#### Средние

- **BUG-QA-3.** Страница privacy: глобальное правило `ul { list-style: none }` убирает маркеры списков; у `.privacy-container ul` задан только `padding-left`, `list-style-type` не восстановлен — списки выглядят как обычный текст.

- **BUG-QA-4.** Скрытые инпуты калькулятора: для визуально скрытого контента используется устаревшее свойство `clip: rect(0,0,0,0)`. Рекомендуется заменить на современный приём (например, `clip-path: inset(50%)`) с сохранением доступности для скринридеров.

- **BUG-QA-5.** Неиспользуемый класс в разметке: у блока рейтинга в hero задан класс `desktop-trust-badge` — в CSS он нигде не используется, используется только `trust-badge` и `hero-rating`.

#### Низкие / рекомендации

- **BUG-QA-6.** Viewport: в `index.html` указано `viewport-fit=cover`, в `privacy.html` — только `width=device-width, initial-scale=1`. Для единообразия и safe-area можно добавить `viewport-fit=cover` на privacy.

- **BUG-QA-7.** Модальное окно в состоянии «успех»: смена `aria-labelledby` на текст успеха реализована, но у самого диалога при смене контента можно явно задать `aria-label` для состояния успеха (по желанию).

---

## Часть 2. Senior Fullstack Developer — Планы работ

### 2.1. План рефакторинга и оптимизации кода

- [ ] **REF-1.** Вынести константы калькулятора (PRICE_MAP, коэффициенты) в отдельный объект/модуль в начале `script.js` или в отдельный файл `js/calculator-config.js` (если выделять модули).
- [ ] **REF-2.** JS: разбить `script.js` на логические модули (калькулятор, бургер, модалка, ScrollSpy, карусель, плашка калькулятора + десктоп-нав) с сохранением IIFE и без глобальных переменных; при необходимости использовать один общий namespace или порядок подключения скриптов.
- [x] **REF-3.** CSS: вынести все breakpoint-числа (768, 769, 900, 1024 и т.д.) в переменные `:root` (например, `--bp-mobile`, `--bp-tablet`, `--bp-desktop`) и использовать в медиа-запросах через `min-width`/`max-width` для единообразия.
- [ ] **REF-4.** Уменьшить глубину селекторов (по правилам — не более 3 уровней) там, где она превышена (например, в блоках calculator, modal, reviews).
- [x] **REF-5.** Заменить магические числа в JS (100, 24, 50, 0.5, 0.7 и т.д.) на именованные константы с комментариями (header offset, gap, threshold и т.д.).
- [x] **REF-6.** Унифицировать обработку `DOMContentLoaded` и повторного вызова init-функций (все модули уже проверяют readyState; при разбиении на файлы сохранить тот же подход).

### 2.2. План исправления багов, найденных QA

- [x] **FIX-QA-1.** Увеличить минимальный размер кнопки «Позвонить» на мобиле до 44×44 px: в `@media (max-width: 768px)` для `.btn-call-desktop` задать `min-width: 44px`, `min-height: 44px`, `width: 44px`, `height: 44px` (и при необходимости подправить padding/иконку).
- [x] **FIX-QA-2.** Убрать `outline: none` у `.footer__social a` в состоянии `:focus`/`:focus-visible`; добавить видимое выделение фокуса (например, `outline: 2px solid var(--color-accent); outline-offset: 2px`).
- [x] **FIX-QA-3.** На странице privacy: для `.privacy-container ul` задать `list-style-type: disc` (или другой подходящий тип), чтобы маркеры списков отображались.
- [x] **FIX-QA-4.** Класс визуально скрытых инпутов: заменить `clip: rect(0,0,0,0)` на современный способ (например, `clip-path: inset(50%); overflow: hidden;` и т.п.), сохранив доступность (инпуты остаются в DOM и фокусируемыми).
- [x] **FIX-QA-5.** Удалить неиспользуемый класс `desktop-trust-badge` из разметки hero (оставить `trust-badge` и `hero-rating`).
- [x] **FIX-QA-6.** В `privacy.html` в мета viewport при необходимости добавить `viewport-fit=cover` для единообразия с главной страницей.
- [x] **FIX-QA-7.** (Опционально) В состоянии «успех» модалки задать у диалога `aria-label` с кратким описанием (например, «Заявка отправлена»).

### 2.3. Дополнительные баги (найденные при самостоятельной проверке) и план исправления

- [x] **FIX-DEV-1.** Социальные иконки в header: у `.social-icons__item:focus` задано `outline: none` без отдельного оформления для `:focus-visible`. Убедиться, что при фокусе с клавиатуры есть видимое кольцо (например, оставить/добавить стили в `:focus-visible` и не гасить outline только для мыши).
- [x] **FIX-DEV-2.** Калькулятор: при отсутствии выбранного радиуса (например, при отключении JS и сбросе) `calculateTotal` возвращает `null` и отображается «—». Проверить, что в разметке всегда выбран один radius (сейчас R16–R18 по умолчанию) и при инициализации вызывается `handleCalculatorChange` — дополнительных изменений не требуется; зафиксировать в комментарии или тесте.
- [x] **FIX-DEV-3.** ScrollSpy: в SECTION_IDS есть `'services'`, но при `activeId === 'services'` он обнуляется, при этом в навигации нет ссылки на `#services`. Либо добавить в десктоп/мобильное меню пункт «Доп. услуги» с якорем `#services`, либо явно исключить `services` из SECTION_IDS и не наблюдать эту секцию — для согласованности логики и интерфейса.
- [x] **FIX-DEV-4.** Модалка: при закрытии по Escape фокус возвращается на элемент, открывший модалку. Если модалку открыли по клику на кнопку «Зафиксировать цену» в плашке калькулятора, при скролле эта кнопка может быть вне зоны видимости — проверить, что фокус не уходит в пустое место; при необходимости возвращать фокус на первый фокусируемый элемент внутри модалки или на кнопку закрытия перед скрытием.

### 2.4. Ненужный код (удалить или не подключать)

- [x] **DEL-1.** В `css/styles.css` блок «Location» (приблизительно строки 1226–2292): классы `.location__title`, `.location__container`, `.location__label`, `.location__address`, `.location__info`, `.location__landmark`, `.location__hours`, `.location__phone`, `.location__phone-row`, `.location__map-wrap`, `.map-wrapper`, `.location__map-btn`, `.location__map-attribution`, `.location__map-attribution--city`, `.location__map-attribution--place` и связанные правила не используются в `index.html` (секция контактов использует `.contacts-bento`, `.contacts-grid`, `.info-card`, `.contacts-map-wrap`). Класс `.location` используется на секции вместе с `.contacts-bento`. Удалить неиспользуемые селекторы `.location__*` и `.map-wrapper`, `.location__map-wrap`, оставив только те правила `.location`, которые реально применяются к секции (например, отступы), если они не дублируются в `.contacts-bento`.
- [x] **DEL-2.** Класс `desktop-trust-badge` в HTML — удалить (см. FIX-QA-5).

### 2.5. Оптимизация изображений и lazyload

- [x] **IMG-1.** Все контентные изображения в USP, upsell и отзывах уже в формате WebP и с `loading="lazy"` и `decoding="async"`. Проверить, что ниже первого экрана ни у одного изображения нет `loading="eager"` по умолчанию; при необходимости явно задать `loading="lazy"` для всех некритичных картинок.
- [ ] **IMG-2.** Hero: фоновое изображение задано в CSS (`.hero__bg`), нативно lazy применить нельзя. Варианты: (1) оставить как есть; (2) подгружать фон через JS при появлении секции в viewport (Intersection Observer) и выставлять `background-image` — уменьшает начальную загрузку. Реализовывать без изменения визуала (то же изображение и размеры).
- [x] **IMG-3.** Иконки в калькуляторе (SVG) и в отзывах (логотипы 2ГИС, Яндекс) — не конвертировать, оставить как есть; при необходимости убедиться, что у них есть `width`/`height` и корректный `alt` (декоративные — пустой `alt`).
- [x] **IMG-4.** При наличии изображений без явных `width` и `height` добавить атрибуты для снижения CLS (уже есть у большинства; проверить все `<img>` на главной и на privacy).

### 2.6. Доступность (WCAG, WAI-ARIA, лучшие практики)

- [x] **A11Y-1.** Исправить минимальный размер touch-target для кнопки «Позвонить» на мобиле (44×44) — см. FIX-QA-1.
- [x] **A11Y-2.** Восстановить видимое выделение фокуса для ссылок в футере и для соц-иконок в header — см. FIX-QA-2, FIX-DEV-1.
- [x] **A11Y-3.** Визуально скрытые инпуты: заменить устаревший `clip` на современный приём, сохранив доступность — см. FIX-QA-4.
- [x] **A11Y-4.** Проверить контраст текста и кнопок (WCAG AA: 4.5:1 для обычного текста, 3:1 для крупного). Цвета в `:root` уже заданы; при изменении цветов перепроверять контраст.
- [x] **A11Y-5.** У кнопок карусели отзывов есть `aria-label` («Предыдущий/Следующий отзыв»). Проверить, что область карусели имеет осмысленное имя (например, `aria-label` у контейнера с `role="region"` уже задан — «Карусель отзывов»).
- [x] **A11Y-6.** Модальное окно: при открытии фокус переносится на первый фокусируемый элемент, при закрытии — возвращается на открывающий элемент; при состоянии «успех» фокус переносится на кнопку закрытия. Убедиться, что при закрытии модалки фокус не попадает на невидимый или скрытый элемент (см. FIX-DEV-4).
- [x] **A11Y-7.** Форма записи: поля с ошибкой помечаются классом `modal__field--invalid`; при необходимости добавить `aria-invalid="true"` и `aria-describedby` на сообщение об ошибке для скринридеров (если решите выводить текст ошибки).
- [x] **A11Y-8.** Skip-link ведёт к `#main-content` на главной и к `#main` на privacy; у соответствующих main заданы `tabindex="-1"` для программного фокуса — проверить работу при навигации только с клавиатуры.

---

## Контроль перед завершением

- [x] Все пункты из раздела 2.2 (исправление багов QA) выполнены или явно отложены с причиной.
- [x] Все пункты из раздела 2.3 (доп. баги), 2.4 (удаление лишнего кода), 2.5 (изображения), 2.6 (доступность) просмотрены и при необходимости внедрены.
- [ ] Регресс по сценариям из раздела 1.1 пройден после изменений.
- [x] UI и вёрстка визуально не изменены (только исправления багов, доступности и оптимизации без смены дизайна).
